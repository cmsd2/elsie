Originally written by sffubs.
Enhanced by me (cmsd2).
On it's way to a rewrite to remove the cruft.
